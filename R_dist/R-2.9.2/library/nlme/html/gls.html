<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Fit Linear Model Using Generalized Least Squares</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for gls {nlme}"><tr><td>gls {nlme}</td><td align="right">R Documentation</td></tr></table>
<h2>Fit Linear Model Using Generalized Least Squares</h2>


<h3>Description</h3>

<p>
This function fits a linear model using generalized least
squares. The errors are allowed to be correlated and/or have unequal
variances.
</p>


<h3>Usage</h3>

<pre>
gls(model, data, correlation, weights, subset, method, na.action,
    control, verbose)
## S3 method for class 'gls':
update(object, model., ..., evaluate = TRUE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
an object inheriting from class <code>gls</code>, representing
a generalized least squares fitted linear model.</td></tr>
<tr valign="top"><td><code>model</code></td>
<td>
a two-sided linear formula object describing the
model, with the response on the left of a <code>~</code> operator and the
terms, separated by <code>+</code> operators, on the right.</td></tr>
<tr valign="top"><td><code>model.</code></td>
<td>
Changes to the model &ndash; see <code>update.formula</code> for
details.</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
an optional data frame containing the variables named in
<code>model</code>, <code>correlation</code>, <code>weights</code>, and
<code>subset</code>. By default the variables are taken from the
environment from which <code>gls</code> is called.</td></tr>
<tr valign="top"><td><code>correlation</code></td>
<td>
an optional <code>corStruct</code> object describing the
within-group correlation structure. See the documentation of
<code>corClasses</code> for a description of the available <code>corStruct</code>
classes. If a grouping variable is to be used, it must be specified in
the <code>form</code> argument to the <code>corStruct</code>
constructor. Defaults to <code>NULL</code>, corresponding to uncorrelated 
errors.</td></tr>
<tr valign="top"><td><code>weights</code></td>
<td>
an optional <code>varFunc</code> object or one-sided formula
describing the within-group heteroscedasticity structure. If given as
a formula, it is used as the argument to <code>varFixed</code>,
corresponding to fixed variance weights. See the documentation on
<code>varClasses</code> for a description of the available <code>varFunc</code>
classes. Defaults to <code>NULL</code>, corresponding to homoscedastic
errors.</td></tr>
<tr valign="top"><td><code>subset</code></td>
<td>
an optional expression indicating which subset of the rows of
<code>data</code> should  be  used in the fit. This can be a logical
vector, or a numeric vector indicating which observation numbers are
to be included, or a  character  vector of the row names to be
included.  All observations are included by default.</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
a character string.  If <code>"REML"</code> the model is fit by
maximizing the restricted log-likelihood.  If <code>"ML"</code> the
log-likelihood is maximized.  Defaults to <code>"REML"</code>.</td></tr>
<tr valign="top"><td><code>na.action</code></td>
<td>
a function that indicates what should happen when the
data contain <code>NA</code>s.  The default action (<code>na.fail</code>) causes
<code>gls</code> to print an error message and terminate if there are any
incomplete observations.</td></tr>
<tr valign="top"><td><code>control</code></td>
<td>
a list of control values for the estimation algorithm to
replace the default values returned by the function <code>glsControl</code>.
Defaults to an empty list.</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
an optional logical value. If <code>TRUE</code> information on
the evolution of the iterative algorithm is printed. Default is
<code>FALSE</code>.</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
some methods for this generic require additional
arguments.  None are used in this method.</td></tr>
<tr valign="top"><td><code>evaluate</code></td>
<td>
If <code>TRUE</code> evaluate the new call else return the call.</td></tr>
</table>

<h3>Value</h3>

<p>
an object of class <code>gls</code> representing the linear model
fit. Generic functions such as <code>print</code>, <code>plot</code>, and 
<code>summary</code> have methods to show the results of the fit. See
<code>glsObject</code> for the components of the fit. The functions
<code>resid</code>, <code>coef</code>, and <code>fitted</code> can be used to extract
some of its components.</p>

<h3>Author(s)</h3>

<p>
Jose Pinheiro <a href="mailto:jcp@research.bell-labs.com">jcp@research.bell-labs.com</a>, Douglas Bates
<a href="mailto:bates@stat.wisc.edu">bates@stat.wisc.edu</a>
</p>


<h3>References</h3>

<p>
The different correlation structures available for the
<code>correlation</code> argument are described in Box, G.E.P., Jenkins,
G.M., and Reinsel G.C. (1994), Littel, R.C., Milliken, G.A., Stroup,
W.W., and Wolfinger, R.D. (1996), and Venables, W.N. and Ripley,
B.D. (1997). The use of variance functions for linear 
and nonlinear models is presented in detail in Carroll, R.J. and Ruppert,
D. (1988) and Davidian, M. and Giltinan, D.M. (1995).  
</p>
<p>
Box, G.E.P., Jenkins, G.M., and Reinsel G.C. (1994) "Time Series
Analysis: Forecasting and Control", 3rd Edition, Holden-Day. 
</p>
<p>
Carroll, R.J. and Ruppert, D. (1988) "Transformation and Weighting in
Regression", Chapman and Hall.
</p>
<p>
Davidian, M. and Giltinan, D.M. (1995) "Nonlinear Mixed Effects Models
for Repeated Measurement Data", Chapman and Hall.
</p>
<p>
Littel, R.C., Milliken, G.A., Stroup, W.W., and Wolfinger, R.D. (1996)
"SAS Systems for Mixed Models", SAS Institute.
</p>
<p>
Pinheiro, J.C., and Bates, D.M. (2000) "Mixed-Effects Models
in S and S-PLUS", Springer, esp. pp. 100, 461.  
</p>
<p>
Venables, W.N. and Ripley, B.D. (1997) "Modern Applied Statistics with
S-PLUS", 2nd Edition, Springer-Verlag.
</p>


<h3>See Also</h3>

<p>
<code><a href="corClasses.html">corClasses</a></code>,
<code><a href="glsControl.html">glsControl</a></code>,
<code><a href="glsObject.html">glsObject</a></code>,
<code><a href="glsStruct.html">glsStruct</a></code>,
<code><a href="plot.gls.html">plot.gls</a></code>, 
<code><a href="predict.gls.html">predict.gls</a></code>, 
<code><a href="qqnorm.gls.html">qqnorm.gls</a></code>, 
<code><a href="residuals.gls.html">residuals.gls</a></code>, 
<code><a href="summary.gls.html">summary.gls</a></code>, 
<code><a href="varClasses.html">varClasses</a></code>,
<code><a href="varFunc.html">varFunc</a></code>
</p>


<h3>Examples</h3>

<pre>
# AR(1) errors within each Mare
fm1 &lt;- gls(follicles ~ sin(2*pi*Time) + cos(2*pi*Time), Ovary,
           correlation = corAR1(form = ~ 1 | Mare))
# variance increases as a power of the absolute fitted values
fm2 &lt;- update(fm1, weights = varPower())
</pre>



<hr><div align="center">[Package <em>nlme</em> version 3.1-93 <a href="00Index.html">Index</a>]</div>

</body></html>
