<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Data Input from Spreadsheet</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for read.DIF {utils}"><tr><td>read.DIF {utils}</td><td align="right">R Documentation</td></tr></table>
<h2>Data Input from Spreadsheet</h2>


<h3>Description</h3>

<p>
Reads a file in Data Interchange Format (DIF) and creates a data frame
from it.  DIF is a format for data matrices such as single spreadsheets.
</p>


<h3>Usage</h3>

<pre>
read.DIF(file, header = FALSE,
           dec = ".", row.names, col.names,
           as.is = !stringsAsFactors,
           na.strings = "NA", colClasses = NA, nrows = -1,
           skip = 0, check.names = TRUE,
           blank.lines.skip = TRUE,
           stringsAsFactors = default.stringsAsFactors(),
           transpose = FALSE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>file</code></td>
<td>
the name of the file which the data are to be read from,
or a connection, or a complete URL.
<br>
The name <code>"clipboard"</code> may also be used on Windows, in which
case <code>read.DIF("clipboard")</code> will look for a DIF format entry
in the Windows clipboard.
</td></tr>
<tr valign="top"><td><code>header</code></td>
<td>
a logical value indicating whether the spreadsheet contains the
names of the variables as its first line.  If missing, the value is
determined from the file format: <code>header</code> is set to <code>TRUE</code>
if and only if the first row contains only character values and
the top left cell is empty.</td></tr>
<tr valign="top"><td><code>dec</code></td>
<td>
the character used in the file for decimal points.</td></tr>
<tr valign="top"><td><code>row.names</code></td>
<td>
a vector of row names.  This can be a vector giving
the actual row names, or a single number giving the column of the
table which contains the row names, or character string giving the
name of the table column containing the row names.
<br>
If there is a header and the first row contains one fewer field than
the number of columns, the first column in the input is used for the
row names.  Otherwise if <code>row.names</code> is missing, the rows are
numbered.
<br>
Using <code>row.names = NULL</code> forces row numbering.
</td></tr>
<tr valign="top"><td><code>col.names</code></td>
<td>
a vector of optional names for the variables.
The default is to use <code>"V"</code> followed by the column number.</td></tr>
<tr valign="top"><td><code>as.is</code></td>
<td>
the default behavior of <code>read.DIF</code> is to convert
character variables (which are not converted to logical, numeric or
complex) to factors.  The variable <code>as.is</code> controls the
conversion of columns not otherwise specified by <code>colClasses</code>.
Its value is either a vector of logicals (values are recycled if
necessary), or a vector of numeric or character indices which
specify which columns should not be converted to factors.
<br>
Note: to suppress all conversions including those of numeric
columns, set <code>colClasses = "character"</code>.
<br>
Note that <code>as.is</code> is specified per column (not per
variable) and so includes the column of row names (if any) and any
columns to be skipped.
</td></tr>
<tr valign="top"><td><code>na.strings</code></td>
<td>
a character vector of strings which are to be
interpreted as <code><a href="../../base/html/NA.html">NA</a></code> values.  Blank fields are also
considered to be missing values in logical, integer, numeric and
complex fields.</td></tr>
<tr valign="top"><td><code>colClasses</code></td>
<td>
character.  A vector of classes to be assumed for
the columns.  Recycled as necessary, or if the character vector is
named, unspecified values are taken to be <code>NA</code>.
<br>
Possible values are <code>NA</code> (when <code><a href="type.convert.html">type.convert</a></code> is
used), <code>"NULL"</code> (when the column is skipped), one of the atomic
vector classes (logical, integer, numeric, complex, character, raw),
or <code>"factor"</code>, <code>"Date"</code> or <code>"POSIXct"</code>.  Otherwise
there needs to be an <code>as</code> method (from package <span class="pkg">methods</span>)
for conversion from <code>"character"</code> to the specified formal
class.
<br>
Note that <code>colClasses</code> is specified per column (not per
variable) and so includes the column of row names (if any).
</td></tr>
<tr valign="top"><td><code>nrows</code></td>
<td>
the maximum number of rows to read in.  Negative values
are ignored.</td></tr>
<tr valign="top"><td><code>skip</code></td>
<td>
the number of lines of the data file to skip before
beginning to read data.</td></tr>
<tr valign="top"><td><code>check.names</code></td>
<td>
logical.  If <code>TRUE</code> then the names of the
variables in the data frame are checked to ensure that they are
syntactically valid variable names.  If necessary they are adjusted
(by <code><a href="../../base/html/make.names.html">make.names</a></code>) so that they are, and also to ensure
that there are no duplicates.</td></tr>
<tr valign="top"><td><code>blank.lines.skip</code></td>
<td>
logical: if <code>TRUE</code> blank lines in the
input are ignored.</td></tr>
<tr valign="top"><td><code>stringsAsFactors</code></td>
<td>
logical: should character vectors be converted
to factors?</td></tr>
<tr valign="top"><td><code>transpose</code></td>
<td>
logical, indicating if the row and column
interpretation should be transposed.  Microsoft's Excel has been
known to produce (non-standard conforming) DIF files which would
need <code>transpose = TRUE</code> to be read correctly.</td></tr>
</table>

<h3>Value</h3>

<p>
A data frame (<code><a href="../../base/html/data.frame.html">data.frame</a></code>) containing a representation of
the data in the file.  Empty input is an error unless <code>col.names</code>
is specified, when a 0-row data frame is returned: similarly giving
just a header line if <code>header = TRUE</code> results in a 0-row data frame.</p>

<h3>Note</h3>

<p>
The columns referred to in <code>as.is</code> and <code>colClasses</code> include
the column of row names (if any).
</p>
<p>
Less memory will be used if <code>colClasses</code> is specified as one of
the six atomic vector classes.
</p>


<h3>Author(s)</h3>

<p>
R Core; <code>transpose</code> option by
Christoph Buser, ETH Zurich
</p>


<h3>References</h3>

<p>
The DIF format specification can be found by searching on
<a href="http://www.wotsit.org/">http://www.wotsit.org/</a>; the optional header fields are ignored.
See also
<a href="http://en.wikipedia.org/wiki/Data_Interchange_Format">http://en.wikipedia.org/wiki/Data_Interchange_Format</a>.
</p>
<p>
The term is likely to lead to confusion: Windows will have a
&lsquo;Windows Data Interchange Format (DIF) data format&rsquo; as part of
its WinFX system, which may or may not be compatible.
</p>


<h3>See Also</h3>

<p>
The <EM>R Data Import/Export</EM> manual.
</p>
<p>
<code><a href="../../base/html/scan.html">scan</a></code>, <code><a href="type.convert.html">type.convert</a></code>,
<code><a href="read.fwf.html">read.fwf</a></code> for reading <EM>f</EM>ixed <EM>w</EM>idth
<EM>f</EM>ormatted input;
<code><a href="read.table.html">read.table</a></code>;
<code><a href="../../base/html/data.frame.html">data.frame</a></code>.
</p>


<h3>Examples</h3>

<pre>
## read.DIF() needs transpose=TRUE for file exported from Excel
udir &lt;- system.file("misc", package="utils")
dd &lt;- read.DIF(file.path(udir, "exDIF.dif"), header= TRUE, transpose=TRUE)
dc &lt;- read.csv(file.path(udir, "exDIF.csv"), header= TRUE)
stopifnot(identical(dd,dc), dim(dd) == c(4,2))
</pre>



<hr><div align="center">[Package <em>utils</em> version 2.9.2 <a href="00Index.html">Index</a>]</div>

</body></html>
