<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Prediction/Construction wrapper functions for GAM smooth terms</title>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<link rel="stylesheet" type="text/css" href="../../R.css">
</head><body>

<table width="100%" summary="page for smoothCon {mgcv}"><tr><td>smoothCon {mgcv}</td><td align="right">R Documentation</td></tr></table>
<h2>Prediction/Construction wrapper functions for GAM smooth terms</h2>


<h3>Description</h3>

<p>
Wrapper functions for construction of and prediction from smooth
terms in a GAM. The purpose of the wrappers is to allow user-transparant
re-parameterization of smooth terms, in order to allow identifiability
constraints to be absorbed into the parameterization of each term, if required.
The routine also handles `by' variables and construction of identifiability constraints automatically, 
although this behaviour can be over-ridden.
</p>


<h3>Usage</h3>

<pre>
smoothCon(object,data,knots,absorb.cons=FALSE,
          scale.penalty=TRUE,n=nrow(data),dataX=NULL,
          null.space.penalty=FALSE)
PredictMat(object,data,n=nrow(data))
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>object</code></td>
<td>
is a smooth specification object or a smooth object.</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
A data frame, model frame or list containing the values of the 
(named) covariates at which the smooth term is to be 
evaluated. If it's a list then <code>n</code> must be supplied.</td></tr>
<tr valign="top"><td><code>knots</code></td>
<td>
An optional data frame supplying any knot locations to be
supplied for basis construction.</td></tr>
<tr valign="top"><td><code>absorb.cons</code></td>
<td>
Set to <code>TRUE</code> in order to have identifiability
constraints absorbed into the basis.</td></tr>
<tr valign="top"><td><code>scale.penalty</code></td>
<td>
should the penalty coefficient matrix be scaled to have
approximately the same `size' as the inner product of the terms model matrix
with itself? This can improve the performance of <code><a href="gamm.html">gamm</a></code> fitting.</td></tr>
<tr valign="top"><td><code>n</code></td>
<td>
number of values for each covariate, or if a covariate is a matrix, 
the number of rows in that matrix: must be supplied explicitly if <code>data</code> is a list. </td></tr>
<tr valign="top"><td><code>dataX</code></td>
<td>
Sometimes the basis should be set up using data in <code>data</code>, but the model matrix
should be constructed with another set of data provided in <code>dataX</code> &mdash; <code>n</code> is assumed to 
be the same for both. Facilitates smooth id's.</td></tr>
<tr valign="top"><td><code>null.space.penalty</code></td>
<td>
Should an extra penalty be added to the smooth which will penalize the 
components of the smooth in the penalty null space: provides a way of penalizing terms out of the model altogether.</td></tr>
</table>

<h3>Details</h3>

<p>
These wrapper functions exist to allow smooths specified using
<code><a href="smooth.construct.html">smooth.construct</a></code> and <code><a href="Predict.matrix.html">Predict.matrix</a></code> method
functions to be re-parameterized so that identifiability constraints are no
longer required in fitting. This is done in a user transparent
manner, but is typically of no importance in use of GAMs. The routine's 
also handle <code>by</code> variables and will create default identifiability 
constraints.
</p>
<p>
If a user defined smooth constructor handles <code>by</code> variables itself, then its 
returned smooth object should contain an object <code>by.done</code>. If this does not exist 
then <code>smoothCon</code> will use the default code. Similarly if a user defined <code>Predict.matrix</code> 
method handles <code>by</code> variables internally then the returned matrix should have a 
<code>"by.done"</code> attribute.
</p>
<p>
Default centering constraints, that terms should sum to zero over the covariates, are produced unless 
the smooth constructor includes a matrix <code>C</code> of constraints. To have no constraints (in which case 
you had better have a full rank penalty!) the matrix <code>C</code> should have no rows.
</p>
<p>
<code>smoothCon</code> returns a list of smooths because factor <code>by</code> variables result in multiple copies 
of a smooth, each multiplied by the dummy variable associated with one factor level. <code>smoothCon</code> modifies 
the smooth object labels in the presence of <code>by</code> variables, to ensure that they are unique, it also stores 
the level of a by variable factor associated with a smooth, for later use by <code>PredMat</code>.
</p>
<p>
The parameterization used by <code><a href="gam.html">gam</a></code> can be controlled via
<code><a href="gam.control.html">gam.control</a></code>.
</p>


<h3>Value</h3>

<p>
From <code>smoothCon</code> a list of <code>smooth</code> objects returned by the
appropriate <code><a href="smooth.construct.html">smooth.construct</a></code> method function. If constraints are
to be absorbed then the objects will have  attributes <code>"qrc"</code> and
<code>"nCons"</code>, the qr decomposition of the constraint matrix (returned by
<code><a href="../../base/html/qr.html">qr</a></code>) and the number of constraints, respectively: these are  used in
the re-parameterization. 
<br>
For <code>predictMat</code> a matrix which will map the parameters associated with
the smooth to the vector of values of the smooth evaluated at the covariate
values given in <code>object</code>.</p>

<h3>Author(s)</h3>

<p>
Simon N. Wood <a href="mailto:simon.wood@r-project.org">simon.wood@r-project.org</a>
</p>


<h3>References</h3>

<p>
<a href="http://www.maths.bath.ac.uk/~sw283/">http://www.maths.bath.ac.uk/~sw283/</a>
</p>


<h3>See Also</h3>

<p>
<code><a href="gam.control.html">gam.control</a></code>,
<code><a href="smooth.construct.html">smooth.construct</a></code>, <code><a href="Predict.matrix.html">Predict.matrix</a></code>
</p>



<hr><div align="center">[Package <em>mgcv</em> version 1.5-5 <a href="00Index.html">Index</a>]</div>

</body></html>
